{% extends 'base.html' %}
{% load static %}

{% block title %}جميع الإصلاحات{% endblock %}

{% block content %}

        <a href="{% url 'repair:listrepairs' %}"><h2 class="fw-b h1 ta-r m-t-lg m-b-lg m-r-lg">اﻹصلاحات </h2></a>
        <form dir="rtl" method="get" class="m-l-lg m-r-lg ta-r">
            <label> العميل</label>
            {{ filter.form.customer_id }}
            <br>
            <label>المبلغ كامل : </label>
            {{ filter.form.total_price }}
            <label>المدفوع : </label>
            {{ filter.form.payed }}
            <br>
            <br>
            <label>حالة الاستلام من الورشة : </label>
            {{ filter.form.state_to_office }}
            <label>حالة الاستلام من المكتب : </label>
            {{ filter.form.state_to_store }}
            <label>حالة التسليم للعميل : </label>
            {{ filter.form.state_to_customer }}
            <br>
            <button class="btn btn-app m-t-lg" type="submit">Search</button>
        </form>
        <div class="row text-center">
            <div class="card m-t-lg">

                <div class="card-block">
                    <div class="table-responsive">
                        <table dir="rtl" class=" table table-striped table-borderless table-vcenter text-center ">
                            <thead style="background-color: #8fdf82;">
                                <tr>
                                    <th style="width: 1%;"></th>
                                    <th class="text-center ">
                                        العميل<br>
                                    </th>
                                    <th class="text-center">
                                        المبلغ كامل<br>
                                    </th>
                                    <th class="text-center">
                                        المدفوع<br>
                                    </th>
                                    <th class="text-center">
                                         القطع<br>
                                    </th>
                                    <th class="text-center">
                                        حالة الاستلام من الورشة<br>
                                    </th>
                                    <th class="text-center">
                                         حالة الاستلام من المكتب<br>
                                    </th>
                                    <th class="text-center">
                                         حالة التسليم للعميل<br>
                                    </th>
                                </tr>
                            </thead>
                            <button class="btn btn-app btn-block" data-toggle="modal" data-target="#modal-large" type="button">Launch Modal</button>
                            <tbody>
                                {% for order in filter.qs %}
                                    <tr>
                                        <td><code>  </code></td>
                                        <td><a data-toggle="modal" data-target="#modal-large{{order.pk}}">{{ order.customer_id.name }}</a></td>
                                        <td>{{ order.total_price }}</td>
                                        <td>{{ order.payed }}</td>
                                        <td>
{#                                            Loop for the related models inside orders. #}
{#                                            Why It's named items?  check the repair/models.py line 23 #}
                                            {% for item in order.items.all %}
                                                {{ item.type1 }}،
                                                {{ item.type2 }}،
                                                {{ item.type3 }}
                                                <br>
                                            {% endfor %}
                                        </td>
                                        <td>{% if order.state_to_office %}
                                            <i class="ion-checkmark text-green"></i>
                                            {% else %}
                                            <i class="ion-close text-red"></i>
                                        {% endif %}</td>
                                        <td>{% if order.state_to_store %}
                                            <i class="ion-checkmark text-green"></i>
                                            {% else %}
                                            <i class="ion-close text-red"></i>
                                        {% endif %}</td>
                                        <td>{% if order.state_to_customer %}
                                            <i class="ion-checkmark text-green"></i>
                                            {% else %}
                                            <i class="ion-close text-red"></i>
                                        {% endif %}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    <!-- Large Modal -->
    {% for order in filter.qs %}
        <div class="modal fade" id="modal-large{{ order.pk }}" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="card-header bg-green bg-inverse">
                        <h4 class="ta-r"> اوردر رقم {{ order.pk }}</h4>
                        <ul class="card-actions">
                            <li>
                                <button data-dismiss="modal" type="button"><i class="ion-close"></i></button>
                            </li>
                        </ul>
                    </div>
                    <div class="card-block">
                        <p>
                            THIS IS ORDER NO. {{ order.pk }} for customer : {{ order.customer_id.name}}
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-sm btn-default" type="button" data-dismiss="modal">Close</button>
                        <button class="btn btn-sm btn-app" type="button" data-dismiss="modal"><i class="ion-checkmark"></i> Ok</button>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
    <!-- End Large Modal -->
{% endblock %}



{% block js %}

{#$("#new").click(function () {#}
{#    var str = "test";#}
{#    console.log(str);#}
{#    $.ajax({#}
{#        url: '{% url 'pages:AddC' %}',#}
{#        data: {},#}
{#        success: function (data) {#}
{#            $('#content').html(data);#}
{#        }#}
{#    });#}
{# });#}

{% endblock %}